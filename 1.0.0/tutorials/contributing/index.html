
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Comprehensive guide to contributing to CoAL: from setting up your development environment to submitting a pull request">
      
      
      
        <link rel="canonical" href="https://cosmo-tech.github.io/CosmoTech-Acceleration-Library/1.0.0/tutorials/contributing/">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../cosmotech-api/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.18">
    
    
      
        <title>Contributing to CoAL - Cosmotech Acceleration Library Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CFira+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Fira Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../stylesheets/templates.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Contributing to CoAL - Cosmotech Acceleration Library Docs" >
      
        <meta  property="og:description"  content="Comprehensive guide to contributing to CoAL: from setting up your development environment to submitting a pull request" >
      
        <meta  property="og:image"  content="https://cosmo-tech.github.io/CosmoTech-Acceleration-Library/1.0.0/assets/images/social/tutorials/contributing.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://cosmo-tech.github.io/CosmoTech-Acceleration-Library/1.0.0/tutorials/contributing/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Contributing to CoAL - Cosmotech Acceleration Library Docs" >
      
        <meta  name="twitter:description"  content="Comprehensive guide to contributing to CoAL: from setting up your development environment to submitting a pull request" >
      
        <meta  name="twitter:image"  content="https://cosmo-tech.github.io/CosmoTech-Acceleration-Library/1.0.0/assets/images/social/tutorials/contributing.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="orange" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#contributing-to-coal" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Cosmotech Acceleration Library Docs" class="md-header__button md-logo" aria-label="Cosmotech Acceleration Library Docs" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cosmotech Acceleration Library Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Contributing to CoAL
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="orange" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Cosmo-Tech/CosmoTech-Acceleration-Library" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Cosmo-Tech/CosmoTech-Acceleration-Library
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../dependencies/" class="md-tabs__link">
          
  
    
  
  Getting started

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../references/coal/cosmotech_api/run/" class="md-tabs__link">
          
  
    
  
  References

        </a>
      </li>
    
  

    
  

    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../csm-data/" class="md-tabs__link">
          
  
    
  
  csm-data

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Cosmotech Acceleration Library Docs" class="md-nav__button md-logo" aria-label="Cosmotech Acceleration Library Docs" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    Cosmotech Acceleration Library Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Cosmo-Tech/CosmoTech-Acceleration-Library" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Cosmo-Tech/CosmoTech-Acceleration-Library
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dependencies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dependencies
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pull_request/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pull Request Checklist
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Contributing to CoAL
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Contributing to CoAL
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="In this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      In this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-your-development-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Setting Up Your Development Environment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Setting Up Your Development Environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#forking-and-cloning-the-repository" class="md-nav__link">
    <span class="md-ellipsis">
      Forking and Cloning the Repository
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installing-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Installing Dependencies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-up-black-for-code-formatting" class="md-nav__link">
    <span class="md-ellipsis">
      Setting Up Black for Code Formatting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-pre-commit-hooks" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring Pre-commit Hooks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-the-coal-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding the CoAL Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding the CoAL Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Core Modules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#store-module-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Store Module Architecture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cli-command-structure" class="md-nav__link">
    <span class="md-ellipsis">
      CLI Command Structure
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementing-a-new-store-feature" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing a New Store Feature
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementing a New Store Feature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-the-module-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Creating the Module Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-the-core-functionality" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing the Core Functionality
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#updating-the-package-initialization" class="md-nav__link">
    <span class="md-ellipsis">
      Updating the Package Initialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Adding Dependencies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-new-csm-data-command" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a new CSM-DATA Command
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creating a new CSM-DATA Command">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-the-command-file" class="md-nav__link">
    <span class="md-ellipsis">
      Creating the Command File
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-the-command" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing the Command
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#registering-the-command" class="md-nav__link">
    <span class="md-ellipsis">
      Registering the Command
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-translation-strings" class="md-nav__link">
    <span class="md-ellipsis">
      Adding Translation Strings
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#writing-unit-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Writing Unit Tests
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Writing Unit Tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-test-files" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Test Files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-unit-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing Unit Tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-the-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Running the Tests
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Documentation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Documentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updating-cli-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Updating CLI Documentation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pull-request-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      Pull Request Checklist
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cosmotech-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Working with the CosmoTech API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../csm-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CSM-DATA
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../datastore/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datastore
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    References
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            References
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    References
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            References
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1_1" id="__nav_4_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    coal
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1">
            <span class="md-nav__icon md-icon"></span>
            coal
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_1_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1_1_1" id="__nav_4_1_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    cosmotech_api
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            cosmotech_api
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/coal/cosmotech_api/run/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    run
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/coal/cosmotech_api/workspace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    workspace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/coal/cosmotech_api/twin_data_layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    twin_data_layer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/coal/cosmotech_api/connection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    connection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/coal/cosmotech_api/parameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_1_1_6" >
        
          
          <label class="md-nav__link" for="__nav_4_1_1_1_6" id="__nav_4_1_1_1_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    runner
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_4_1_1_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1_1_6">
            <span class="md-nav__icon md-icon"></span>
            runner
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/coal/cosmotech_api/runner/metadata/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    metadata
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/coal/cosmotech_api/runner/parameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    parameters
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_1_1_7" >
        
          
          <label class="md-nav__link" for="__nav_4_1_1_1_7" id="__nav_4_1_1_1_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    dataset
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_4_1_1_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1_1_7">
            <span class="md-nav__icon md-icon"></span>
            dataset
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/coal/cosmotech_api/dataset/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_1_2" >
        
          
          <label class="md-nav__link" for="__nav_4_1_1_2" id="__nav_4_1_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    store
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1_2">
            <span class="md-nav__icon md-icon"></span>
            store
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/coal/store/native_python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    native_python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/coal/store/pyarrow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pyarrow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/coal/store/csv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    csv
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/coal/store/store/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    store
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/coal/store/pandas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pandas
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_1_3" >
        
          
          <label class="md-nav__link" for="__nav_4_1_1_3" id="__nav_4_1_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    aws
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1_3">
            <span class="md-nav__icon md-icon"></span>
            aws
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/coal/aws/s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    s3
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_1_4" >
        
          
          <label class="md-nav__link" for="__nav_4_1_1_4" id="__nav_4_1_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    utils
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1_4">
            <span class="md-nav__icon md-icon"></span>
            utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/coal/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cosmotech.coal.utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/coal/utils/postgresql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    postgresql
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_1_5" >
        
          
          <label class="md-nav__link" for="__nav_4_1_1_5" id="__nav_4_1_1_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    csm
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1_5">
            <span class="md-nav__icon md-icon"></span>
            csm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/coal/csm/engine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    engine
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_1_6" >
        
          
          <label class="md-nav__link" for="__nav_4_1_1_6" id="__nav_4_1_1_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    azure
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1_6">
            <span class="md-nav__icon md-icon"></span>
            azure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/coal/azure/blob/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    blob
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/coal/azure/storage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_1_6_3" >
        
          
          <label class="md-nav__link" for="__nav_4_1_1_6_3" id="__nav_4_1_1_6_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    adx
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_4_1_1_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1_6_3">
            <span class="md-nav__icon md-icon"></span>
            adx
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/coal/azure/adx/query/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    query
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/coal/azure/adx/tables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/coal/azure/adx/ingestion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ingestion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/coal/azure/adx/auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/coal/azure/adx/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../csm-data/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    csm-data
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            csm-data
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csm-data/adx-send-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    adx-send-data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csm-data/adx-send-runnerdata/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    adx-send-runnerdata
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csm-data/az-storage-upload/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    az-storage-upload
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csm-data/s3-bucket-delete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    s3-bucket-delete
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csm-data/s3-bucket-download/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    s3-bucket-download
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csm-data/s3-bucket-upload/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    s3-bucket-upload
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../csm-data/api/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Api
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_8" id="__nav_5_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8">
            <span class="md-nav__icon md-icon"></span>
            Api
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csm-data/api/postgres-send-runner-metadata/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    postgres-send-runner-metadata
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csm-data/api/rds-load-csv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rds-load-csv
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csm-data/api/rds-send-csv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rds-send-csv
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csm-data/api/rds-send-store/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rds-send-store
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csm-data/api/run-load-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    run-load-data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csm-data/api/runtemplate-load-handler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    runtemplate-load-handler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csm-data/api/tdl-load-files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tdl-load-files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csm-data/api/tdl-send-files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tdl-send-files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csm-data/api/wsf-load-file/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wsf-load-file
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csm-data/api/wsf-send-file/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wsf-send-file
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../csm-data/store/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Store
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_9" id="__nav_5_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_9">
            <span class="md-nav__icon md-icon"></span>
            Store
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csm-data/store/dump-to-azure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dump-to-azure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csm-data/store/dump-to-postgresql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dump-to-postgresql
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csm-data/store/dump-to-s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dump-to-s3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csm-data/store/list-tables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    list-tables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csm-data/store/load-csv-folder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    load-csv-folder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csm-data/store/load-from-singlestore/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    load-from-singlestore
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csm-data/store/rds-send-store/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rds-send-store
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csm-data/store/reset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    reset
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="In this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      In this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-your-development-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Setting Up Your Development Environment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Setting Up Your Development Environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#forking-and-cloning-the-repository" class="md-nav__link">
    <span class="md-ellipsis">
      Forking and Cloning the Repository
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installing-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Installing Dependencies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-up-black-for-code-formatting" class="md-nav__link">
    <span class="md-ellipsis">
      Setting Up Black for Code Formatting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-pre-commit-hooks" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring Pre-commit Hooks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-the-coal-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding the CoAL Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding the CoAL Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Core Modules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#store-module-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Store Module Architecture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cli-command-structure" class="md-nav__link">
    <span class="md-ellipsis">
      CLI Command Structure
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementing-a-new-store-feature" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing a New Store Feature
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementing a New Store Feature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-the-module-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Creating the Module Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-the-core-functionality" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing the Core Functionality
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#updating-the-package-initialization" class="md-nav__link">
    <span class="md-ellipsis">
      Updating the Package Initialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Adding Dependencies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-new-csm-data-command" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a new CSM-DATA Command
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creating a new CSM-DATA Command">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-the-command-file" class="md-nav__link">
    <span class="md-ellipsis">
      Creating the Command File
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-the-command" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing the Command
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#registering-the-command" class="md-nav__link">
    <span class="md-ellipsis">
      Registering the Command
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-translation-strings" class="md-nav__link">
    <span class="md-ellipsis">
      Adding Translation Strings
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#writing-unit-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Writing Unit Tests
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Writing Unit Tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-test-files" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Test Files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-unit-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing Unit Tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-the-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Running the Tests
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Documentation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Documentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updating-cli-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Updating CLI Documentation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pull-request-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      Pull Request Checklist
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="contributing-to-coal">Contributing to CoAL<a class="headerlink" href="#contributing-to-coal" title="Permanent link">&para;</a></h1>
<div class="admonition abstract">
<p class="admonition-title">Objective</p>
<ul>
<li>Set up your development environment with Black and pre-commit hooks</li>
<li>Understand the CoAL architecture and contribution workflow</li>
<li>Learn how to implement a new feature with a practical example</li>
<li>Master the process of writing unit tests and documentation</li>
<li>Successfully submit a pull request</li>
</ul>
</div>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>Contributing to the CosmoTech Acceleration Library (CoAL) is a great way to enhance the platform's capabilities and share your expertise with the community. This tutorial will guide you through the entire process of contributing a new feature to CoAL, from setting up your development environment to submitting a pull request.</p>
<p>We'll use a practical example throughout this tutorial: implementing a new store write functionality for MongoDB and creating a corresponding csm-data command. This example will demonstrate all the key aspects of the contribution process, including:</p>
<ul>
<li>Setting up your development environment</li>
<li>Understanding the CoAL architecture</li>
<li>Implementing new functionality</li>
<li>Creating CLI commands</li>
<li>Writing unit tests</li>
<li>Documenting your work</li>
<li>Submitting a pull request</li>
</ul>
<p>By the end of this tutorial, you'll have a solid understanding of how to contribute to CoAL and be ready to implement your own features.</p>
<h2 id="setting-up-your-development-environment">Setting Up Your Development Environment<a class="headerlink" href="#setting-up-your-development-environment" title="Permanent link">&para;</a></h2>
<p>Before you start contributing, you need to set up your development environment. This includes forking and cloning the repository, installing dependencies, and configuring code formatting tools.</p>
<h3 id="forking-and-cloning-the-repository">Forking and Cloning the Repository<a class="headerlink" href="#forking-and-cloning-the-repository" title="Permanent link">&para;</a></h3>
<ol>
<li>Fork the CosmoTech-Acceleration-Library repository on GitHub</li>
<li>
<p>Clone your fork locally:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/your-username/CosmoTech-Acceleration-Library.git
<span class="nb">cd</span><span class="w"> </span>CosmoTech-Acceleration-Library
</code></pre></div>
</li>
<li>
<p>Add the upstream repository as a remote:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>remote<span class="w"> </span>add<span class="w"> </span>upstream<span class="w"> </span>https://github.com/Cosmo-Tech/CosmoTech-Acceleration-Library.git
</code></pre></div>
</li>
</ol>
<h3 id="installing-dependencies">Installing Dependencies<a class="headerlink" href="#installing-dependencies" title="Permanent link">&para;</a></h3>
<p>Install the package in development mode along with all development dependencies:</p>
<div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;.[dev]&quot;</span>
</code></pre></div>
<p>This will install the package in editable mode, allowing you to make changes to the code without reinstalling it. It will also install all the development dependencies specified in the <code>pyproject.toml</code> file.</p>
<h3 id="setting-up-black-for-code-formatting">Setting Up Black for Code Formatting<a class="headerlink" href="#setting-up-black-for-code-formatting" title="Permanent link">&para;</a></h3>
<p>CoAL uses <a href="https://github.com/psf/black">Black</a> for code formatting to ensure consistent code style across the codebase. Black is configured in the <code>pyproject.toml</code> file with specific settings for line length, target Python version, and file exclusions.</p>
<p>To manually run Black on your codebase:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Format all Python files in the project</span>
python<span class="w"> </span>-m<span class="w"> </span>black<span class="w"> </span>.

<span class="c1"># Format a specific directory</span>
python<span class="w"> </span>-m<span class="w"> </span>black<span class="w"> </span>cosmotech/coal/

<span class="c1"># Check if files would be reformatted without actually changing them</span>
python<span class="w"> </span>-m<span class="w"> </span>black<span class="w"> </span>--check<span class="w"> </span>.

<span class="c1"># Show diff of changes without writing files</span>
python<span class="w"> </span>-m<span class="w"> </span>black<span class="w"> </span>--diff<span class="w"> </span>.
</code></pre></div>
<h3 id="configuring-pre-commit-hooks">Configuring Pre-commit Hooks<a class="headerlink" href="#configuring-pre-commit-hooks" title="Permanent link">&para;</a></h3>
<p>CoAL uses pre-commit hooks to automatically run checks before each commit, including Black formatting, trailing whitespace removal, and test coverage verification.</p>
<p>To install pre-commit:</p>
<div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>pre-commit
pre-commit<span class="w"> </span>install
</code></pre></div>
<p>Now, when you commit changes, the pre-commit hooks will automatically run and check your code. If any issues are found, the commit will be aborted, and you'll need to fix the issues before committing again.</p>
<p>The pre-commit configuration includes:</p>
<ul>
<li>Trailing whitespace removal</li>
<li>End-of-file fixer</li>
<li>YAML syntax checking</li>
<li>Black code formatting</li>
<li>Pytest checks with coverage requirements</li>
<li>Verification that all functions have tests</li>
</ul>
<h2 id="understanding-the-coal-architecture">Understanding the CoAL Architecture<a class="headerlink" href="#understanding-the-coal-architecture" title="Permanent link">&para;</a></h2>
<p>Before implementing a new feature, it's important to understand the architecture of CoAL and how its components interact.</p>
<h3 id="core-modules">Core Modules<a class="headerlink" href="#core-modules" title="Permanent link">&para;</a></h3>
<p>CoAL is organized into several key modules:</p>
<ul>
<li><strong>coal</strong>: The core library functionality<ul>
<li><strong>store</strong>: Data storage and retrieval</li>
<li><strong>cosmotech_api</strong>: Interaction with the CosmoTech API</li>
<li><strong>aws</strong>: AWS integration</li>
<li><strong>azure</strong>: Azure integration</li>
<li><strong>postgresql</strong>: PostgreSQL integration</li>
<li><strong>utils</strong>: Utility functions</li>
</ul>
</li>
<li><strong>csm_data</strong>: CLI commands for data operations</li>
<li><strong>orchestrator_plugins</strong>: Plugins for csm-orc</li>
<li><strong>translation</strong>: Translation resources</li>
</ul>
<h3 id="store-module-architecture">Store Module Architecture<a class="headerlink" href="#store-module-architecture" title="Permanent link">&para;</a></h3>
<p>The store module provides a unified interface for data storage and retrieval. It's built around the <code>Store</code> class, which provides methods for:</p>
<ul>
<li>Adding and retrieving tables</li>
<li>Executing SQL queries</li>
<li>Listing available tables</li>
<li>Resetting the store</li>
</ul>
<p>The store module also includes adapters for different data formats:</p>
<ul>
<li><strong>native_python</strong>: Python dictionaries and lists</li>
<li><strong>csv</strong>: CSV files</li>
<li><strong>pandas</strong>: Pandas DataFrames</li>
<li><strong>pyarrow</strong>: PyArrow Tables</li>
</ul>
<p>External storage systems are implemented as separate modules that interact with the core <code>Store</code> class:</p>
<ul>
<li><strong>postgresql</strong>: PostgreSQL integration</li>
<li><strong>singlestore</strong>: SingleStore integration</li>
</ul>
<h3 id="cli-command-structure">CLI Command Structure<a class="headerlink" href="#cli-command-structure" title="Permanent link">&para;</a></h3>
<p>The <code>csm_data</code> CLI is organized into command groups, each focused on specific types of operations:</p>
<ul>
<li><strong>api</strong>: Commands for interacting with the CosmoTech API</li>
<li><strong>store</strong>: Commands for working with the CoAL datastore</li>
<li><strong>s3-bucket-*</strong>: Commands for S3 bucket operations</li>
<li><strong>adx-send-scenariodata</strong>: Command for sending scenario data to Azure Data Explorer</li>
<li><strong>az-storage-upload</strong>: Command for uploading to Azure Storage</li>
</ul>
<p>Each command is implemented as a separate Python file in the appropriate directory, using the Click library for command-line interface creation.</p>
<h2 id="implementing-a-new-store-feature">Implementing a New Store Feature<a class="headerlink" href="#implementing-a-new-store-feature" title="Permanent link">&para;</a></h2>
<p>Now that we understand the architecture, let's implement a new store feature: MongoDB integration. This will allow users to write data from the CoAL datastore to MongoDB.</p>
<h3 id="creating-the-module-structure">Creating the Module Structure<a class="headerlink" href="#creating-the-module-structure" title="Permanent link">&para;</a></h3>
<p>First, we'll create a new module for MongoDB integration:</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span>cosmotech/coal/mongodb
touch<span class="w"> </span>cosmotech/coal/mongodb/__init__.py
touch<span class="w"> </span>cosmotech/coal/mongodb/store.py
</code></pre></div>
<h3 id="implementing-the-core-functionality">Implementing the Core Functionality<a class="headerlink" href="#implementing-the-core-functionality" title="Permanent link">&para;</a></h3>
<p>Now, let's implement the core functionality in <code>cosmotech/coal/mongodb/store.py</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Copyright (C) - 2023 - 2025 - Cosmo Tech</span>
<span class="c1"># This document and all information contained herein is the exclusive property -</span>
<span class="c1"># including all intellectual property rights pertaining thereto - of Cosmo Tech.</span>
<span class="c1"># Any use, reproduction, translation, broadcasting, transmission, distribution,</span>
<span class="c1"># etc., to any person is prohibited unless it has been previously and</span>
<span class="c1"># specifically authorized by written means by Cosmo Tech.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">MongoDB store operations module.</span>

<span class="sd">This module provides functions for interacting with MongoDB databases</span>
<span class="sd">for store operations.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">time</span><span class="w"> </span><span class="kn">import</span> <span class="n">perf_counter</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyarrow</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pymongo</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">cosmotech.coal.store.store</span><span class="w"> </span><span class="kn">import</span> <span class="n">Store</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cosmotech.coal.utils.logger</span><span class="w"> </span><span class="kn">import</span> <span class="n">LOGGER</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cosmotech.orchestrator.utils.translate</span><span class="w"> </span><span class="kn">import</span> <span class="n">T</span>


<span class="k">def</span><span class="w"> </span><span class="nf">send_pyarrow_table_to_mongodb</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">pyarrow</span><span class="o">.</span><span class="n">Table</span><span class="p">,</span>
    <span class="n">collection_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">mongodb_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">mongodb_db</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">replace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Send a PyArrow table to MongoDB.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: PyArrow table to send</span>
<span class="sd">        collection_name: MongoDB collection name</span>
<span class="sd">        mongodb_uri: MongoDB connection URI</span>
<span class="sd">        mongodb_db: MongoDB database name</span>
<span class="sd">        replace: Whether to replace existing collection</span>

<span class="sd">    Returns:</span>
<span class="sd">        Number of documents inserted</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert PyArrow table to list of dictionaries</span>
    <span class="n">records</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_pylist</span><span class="p">()</span>

    <span class="c1"># Connect to MongoDB</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">pymongo</span><span class="o">.</span><span class="n">MongoClient</span><span class="p">(</span><span class="n">mongodb_uri</span><span class="p">)</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">client</span><span class="p">[</span><span class="n">mongodb_db</span><span class="p">]</span>

    <span class="c1"># Drop collection if replace is True and collection exists</span>
    <span class="k">if</span> <span class="n">replace</span> <span class="ow">and</span> <span class="n">collection_name</span> <span class="ow">in</span> <span class="n">db</span><span class="o">.</span><span class="n">list_collection_names</span><span class="p">():</span>
        <span class="n">db</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">()</span>

    <span class="c1"># Insert records</span>
    <span class="k">if</span> <span class="n">records</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">db</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]</span><span class="o">.</span><span class="n">insert_many</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">inserted_ids</span><span class="p">)</span>

    <span class="k">return</span> <span class="mi">0</span>


<span class="k">def</span><span class="w"> </span><span class="nf">dump_store_to_mongodb</span><span class="p">(</span>
    <span class="n">store_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">mongodb_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">mongodb_db</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">collection_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Cosmotech_&quot;</span><span class="p">,</span>
    <span class="n">replace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dump Store data to a MongoDB database.</span>

<span class="sd">    Args:</span>
<span class="sd">        store_folder: Folder containing the Store</span>
<span class="sd">        mongodb_uri: MongoDB connection URI</span>
<span class="sd">        mongodb_db: MongoDB database name</span>
<span class="sd">        collection_prefix: Collection prefix</span>
<span class="sd">        replace: Whether to replace existing collections</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_s</span> <span class="o">=</span> <span class="n">Store</span><span class="p">(</span><span class="n">store_location</span><span class="o">=</span><span class="n">store_folder</span><span class="p">)</span>

    <span class="n">tables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">_s</span><span class="o">.</span><span class="n">list_tables</span><span class="p">())</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tables</span><span class="p">):</span>
        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="s2">&quot;coal.logs.database.sending_data&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">mongodb_db</span><span class="p">))</span>
        <span class="n">total_rows</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">_process_start</span> <span class="o">=</span> <span class="n">perf_counter</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">table_name</span> <span class="ow">in</span> <span class="n">tables</span><span class="p">:</span>
            <span class="n">_s_time</span> <span class="o">=</span> <span class="n">perf_counter</span><span class="p">()</span>
            <span class="n">target_collection_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">collection_prefix</span><span class="si">}{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="s2">&quot;coal.logs.database.table_entry&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">target_collection_name</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">_s</span><span class="o">.</span><span class="n">get_table</span><span class="p">(</span><span class="n">table_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="s2">&quot;coal.logs.database.no_rows&quot;</span><span class="p">))</span>
                <span class="k">continue</span>
            <span class="n">_dl_time</span> <span class="o">=</span> <span class="n">perf_counter</span><span class="p">()</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="n">send_pyarrow_table_to_mongodb</span><span class="p">(</span>
                <span class="n">data</span><span class="p">,</span>
                <span class="n">target_collection_name</span><span class="p">,</span>
                <span class="n">mongodb_uri</span><span class="p">,</span>
                <span class="n">mongodb_db</span><span class="p">,</span>
                <span class="n">replace</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">total_rows</span> <span class="o">+=</span> <span class="n">rows</span>
            <span class="n">_up_time</span> <span class="o">=</span> <span class="n">perf_counter</span><span class="p">()</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="s2">&quot;coal.logs.database.row_count&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="n">rows</span><span class="p">))</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="n">T</span><span class="p">(</span><span class="s2">&quot;coal.logs.progress.operation_timing&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">operation</span><span class="o">=</span><span class="s2">&quot;Load from datastore&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">_dl_time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">_s_time</span><span class="si">:</span><span class="s2">0.3</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="n">T</span><span class="p">(</span><span class="s2">&quot;coal.logs.progress.operation_timing&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">operation</span><span class="o">=</span><span class="s2">&quot;Send to MongoDB&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">_up_time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">_dl_time</span><span class="si">:</span><span class="s2">0.3</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="n">_process_end</span> <span class="o">=</span> <span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="n">T</span><span class="p">(</span><span class="s2">&quot;coal.logs.database.rows_fetched&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">table</span><span class="o">=</span><span class="s2">&quot;all tables&quot;</span><span class="p">,</span>
                <span class="n">count</span><span class="o">=</span><span class="n">total_rows</span><span class="p">,</span>
                <span class="n">time</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">_process_end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">_process_start</span><span class="si">:</span><span class="s2">0.3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="s2">&quot;coal.logs.database.store_empty&quot;</span><span class="p">))</span>
</code></pre></div>
<h3 id="updating-the-package-initialization">Updating the Package Initialization<a class="headerlink" href="#updating-the-package-initialization" title="Permanent link">&para;</a></h3>
<p>Next, we need to update the <code>__init__.py</code> file to expose our new function:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Copyright (C) - 2023 - 2025 - Cosmo Tech</span>
<span class="c1"># This document and all information contained herein is the exclusive property -</span>
<span class="c1"># including all intellectual property rights pertaining thereto - of Cosmo Tech.</span>
<span class="c1"># Any use, reproduction, translation, broadcasting, transmission, distribution,</span>
<span class="c1"># etc., to any person is prohibited unless it has been previously and</span>
<span class="c1"># specifically authorized by written means by Cosmo Tech.</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">cosmotech.coal.mongodb.store</span><span class="w"> </span><span class="kn">import</span> <span class="n">dump_store_to_mongodb</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;dump_store_to_mongodb&quot;</span><span class="p">]</span>
</code></pre></div>
<h3 id="adding-dependencies">Adding Dependencies<a class="headerlink" href="#adding-dependencies" title="Permanent link">&para;</a></h3>
<p>We need to add pymongo as a dependency. Update the <code>pyproject.toml</code> file to include pymongo in the optional dependencies:</p>
<div class="highlight"><pre><span></span><code><span class="k">[project.optional-dependencies]</span>
<span class="n">mongodb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;pymongo&gt;=4.3.3&quot;</span><span class="p">]</span>
</code></pre></div>
<h2 id="creating-a-new-csm-data-command">Creating a new CSM-DATA Command<a class="headerlink" href="#creating-a-new-csm-data-command" title="Permanent link">&para;</a></h2>
<p>Now that we have implemented the core functionality, let's create a new csm-data command to expose this functionality to users.</p>
<h3 id="creating-the-command-file">Creating the Command File<a class="headerlink" href="#creating-the-command-file" title="Permanent link">&para;</a></h3>
<p>Create a new file for the command:</p>
<div class="highlight"><pre><span></span><code>touch<span class="w"> </span>cosmotech/csm_data/commands/store/dump_to_mongodb.py
</code></pre></div>
<h3 id="implementing-the-command">Implementing the Command<a class="headerlink" href="#implementing-the-command" title="Permanent link">&para;</a></h3>
<p>Now, let's implement the command:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Copyright (C) - 2023 - 2025 - Cosmo Tech</span>
<span class="c1"># This document and all information contained herein is the exclusive property -</span>
<span class="c1"># including all intellectual property rights pertaining thereto - of Cosmo Tech.</span>
<span class="c1"># Any use, reproduction, translation, broadcasting, transmission, distribution,</span>
<span class="c1"># etc., to any person is prohibited unless it has been previously and</span>
<span class="c1"># specifically authorized by written means by Cosmo Tech.</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">cosmotech.csm_data.utils.click</span><span class="w"> </span><span class="kn">import</span> <span class="n">click</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cosmotech.csm_data.utils.decorators</span><span class="w"> </span><span class="kn">import</span> <span class="n">web_help</span><span class="p">,</span> <span class="n">translate_help</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cosmotech.orchestrator.utils.translate</span><span class="w"> </span><span class="kn">import</span> <span class="n">T</span>


<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">()</span>
<span class="nd">@web_help</span><span class="p">(</span><span class="s2">&quot;csm-data/store/dump-to-mongodb&quot;</span><span class="p">)</span>
<span class="nd">@translate_help</span><span class="p">(</span><span class="s2">&quot;csm_data.commands.store.dump_to_mongodb.description&quot;</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span>
    <span class="s2">&quot;--store-folder&quot;</span><span class="p">,</span>
    <span class="n">envvar</span><span class="o">=</span><span class="s2">&quot;CSM_PARAMETERS_ABSOLUTE_PATH&quot;</span><span class="p">,</span>
    <span class="n">help</span><span class="o">=</span><span class="n">T</span><span class="p">(</span><span class="s2">&quot;csm_data.commands.store.dump_to_mongodb.parameters.store_folder&quot;</span><span class="p">),</span>
    <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;PATH&quot;</span><span class="p">,</span>
    <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
    <span class="n">show_envvar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span>
    <span class="s2">&quot;--collection-prefix&quot;</span><span class="p">,</span>
    <span class="n">help</span><span class="o">=</span><span class="n">T</span><span class="p">(</span><span class="s2">&quot;csm_data.commands.store.dump_to_mongodb.parameters.collection_prefix&quot;</span><span class="p">),</span>
    <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;PREFIX&quot;</span><span class="p">,</span>
    <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="s2">&quot;Cosmotech_&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span>
    <span class="s2">&quot;--mongodb-uri&quot;</span><span class="p">,</span>
    <span class="n">help</span><span class="o">=</span><span class="n">T</span><span class="p">(</span><span class="s2">&quot;csm_data.commands.store.dump_to_mongodb.parameters.mongodb_uri&quot;</span><span class="p">),</span>
    <span class="n">envvar</span><span class="o">=</span><span class="s2">&quot;MONGODB_URI&quot;</span><span class="p">,</span>
    <span class="n">show_envvar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span>
    <span class="s2">&quot;--mongodb-db&quot;</span><span class="p">,</span>
    <span class="n">help</span><span class="o">=</span><span class="n">T</span><span class="p">(</span><span class="s2">&quot;csm_data.commands.store.dump_to_mongodb.parameters.mongodb_db&quot;</span><span class="p">),</span>
    <span class="n">envvar</span><span class="o">=</span><span class="s2">&quot;MONGODB_DB_NAME&quot;</span><span class="p">,</span>
    <span class="n">show_envvar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span>
    <span class="s2">&quot;--replace/--append&quot;</span><span class="p">,</span>
    <span class="s2">&quot;replace&quot;</span><span class="p">,</span>
    <span class="n">help</span><span class="o">=</span><span class="n">T</span><span class="p">(</span><span class="s2">&quot;csm_data.commands.store.dump_to_mongodb.parameters.replace&quot;</span><span class="p">),</span>
    <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">is_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">show_default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">dump_to_mongodb</span><span class="p">(</span>
    <span class="n">store_folder</span><span class="p">,</span>
    <span class="n">collection_prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">mongodb_uri</span><span class="p">,</span>
    <span class="n">mongodb_db</span><span class="p">,</span>
    <span class="n">replace</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>
    <span class="c1"># Import the function at the start of the command</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">cosmotech.coal.mongodb</span><span class="w"> </span><span class="kn">import</span> <span class="n">dump_store_to_mongodb</span>

    <span class="n">dump_store_to_mongodb</span><span class="p">(</span>
        <span class="n">store_folder</span><span class="o">=</span><span class="n">store_folder</span><span class="p">,</span>
        <span class="n">collection_prefix</span><span class="o">=</span><span class="n">collection_prefix</span><span class="p">,</span>
        <span class="n">mongodb_uri</span><span class="o">=</span><span class="n">mongodb_uri</span><span class="p">,</span>
        <span class="n">mongodb_db</span><span class="o">=</span><span class="n">mongodb_db</span><span class="p">,</span>
        <span class="n">replace</span><span class="o">=</span><span class="n">replace</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
<h3 id="registering-the-command">Registering the Command<a class="headerlink" href="#registering-the-command" title="Permanent link">&para;</a></h3>
<p>Update the <code>cosmotech/csm_data/commands/store/__init__.py</code> file to register the new command:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Copyright (C) - 2023 - 2025 - Cosmo Tech</span>
<span class="c1"># This document and all information contained herein is the exclusive property -</span>
<span class="c1"># including all intellectual property rights pertaining thereto - of Cosmo Tech.</span>
<span class="c1"># Any use, reproduction, translation, broadcasting, transmission, distribution,</span>
<span class="c1"># etc., to any person is prohibited unless it has been previously and</span>
<span class="c1"># specifically authorized by written means by Cosmo Tech.</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">cosmotech.csm_data.commands.store.dump_to_azure</span><span class="w"> </span><span class="kn">import</span> <span class="n">dump_to_azure</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cosmotech.csm_data.commands.store.dump_to_postgresql</span><span class="w"> </span><span class="kn">import</span> <span class="n">dump_to_postgresql</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cosmotech.csm_data.commands.store.dump_to_s3</span><span class="w"> </span><span class="kn">import</span> <span class="n">dump_to_s3</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cosmotech.csm_data.commands.store.dump_to_mongodb</span><span class="w"> </span><span class="kn">import</span> <span class="n">dump_to_mongodb</span>  <span class="c1"># Add this line</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cosmotech.csm_data.commands.store.list_tables</span><span class="w"> </span><span class="kn">import</span> <span class="n">list_tables</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cosmotech.csm_data.commands.store.load_csv_folder</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_csv_folder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cosmotech.csm_data.commands.store.load_from_singlestore</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_from_singlestore</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cosmotech.csm_data.commands.store.reset</span><span class="w"> </span><span class="kn">import</span> <span class="n">reset</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cosmotech.csm_data.commands.store.store</span><span class="w"> </span><span class="kn">import</span> <span class="n">store</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;dump_to_azure&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dump_to_postgresql&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dump_to_s3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dump_to_mongodb&quot;</span><span class="p">,</span>  <span class="c1"># Add this line</span>
    <span class="s2">&quot;list_tables&quot;</span><span class="p">,</span>
    <span class="s2">&quot;load_csv_folder&quot;</span><span class="p">,</span>
    <span class="s2">&quot;load_from_singlestore&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reset&quot;</span><span class="p">,</span>
    <span class="s2">&quot;store&quot;</span><span class="p">,</span>
<span class="p">]</span>
</code></pre></div>
<h3 id="adding-translation-strings">Adding Translation Strings<a class="headerlink" href="#adding-translation-strings" title="Permanent link">&para;</a></h3>
<p>Create translation files for the new command:</p>
<ol>
<li>For English (en-US):</li>
</ol>
<div class="highlight"><pre><span></span><code>touch<span class="w"> </span>cosmotech/translation/csm_data/en-US/commands/store/dump_to_mongodb.yml
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nt">commands</span><span class="p">:</span>
<span class="w">  </span><span class="nt">store</span><span class="p">:</span>
<span class="w">    </span><span class="nt">dump_to_mongodb</span><span class="p">:</span>
<span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">Dump store data to MongoDB.</span>
<span class="w">      </span><span class="nt">parameters</span><span class="p">:</span>
<span class="w">        </span><span class="nt">store_folder</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Folder containing the store</span>
<span class="w">        </span><span class="nt">collection_prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix for MongoDB collections</span>
<span class="w">        </span><span class="nt">mongodb_uri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MongoDB connection URI</span>
<span class="w">        </span><span class="nt">mongodb_db</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MongoDB database name</span>
<span class="w">        </span><span class="nt">replace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Replace existing collections</span>
</code></pre></div>
<ol>
<li>For French (fr-FR):</li>
</ol>
<div class="highlight"><pre><span></span><code>touch<span class="w"> </span>cosmotech/translation/csm_data/fr-FR/commands/store/dump_to_mongodb.yml
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nt">commands</span><span class="p">:</span>
<span class="w">  </span><span class="nt">store</span><span class="p">:</span>
<span class="w">    </span><span class="nt">dump_to_mongodb</span><span class="p">:</span>
<span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">Exporter les donnes du store vers MongoDB.</span>
<span class="w">      </span><span class="nt">parameters</span><span class="p">:</span>
<span class="w">        </span><span class="nt">store_folder</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Dossier contenant le store</span>
<span class="w">        </span><span class="nt">collection_prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prfixe pour les collections MongoDB</span>
<span class="w">        </span><span class="nt">mongodb_uri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">URI de connexion MongoDB</span>
<span class="w">        </span><span class="nt">mongodb_db</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Nom de la base de donnes MongoDB</span>
<span class="w">        </span><span class="nt">replace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Remplacer les collections existantes</span>
</code></pre></div>
<h2 id="writing-unit-tests">Writing Unit Tests<a class="headerlink" href="#writing-unit-tests" title="Permanent link">&para;</a></h2>
<p>Testing is a critical part of the contribution process. All new functionality must be thoroughly tested to ensure it works as expected and to prevent regressions.</p>
<h3 id="creating-test-files">Creating Test Files<a class="headerlink" href="#creating-test-files" title="Permanent link">&para;</a></h3>
<p>Create test files for the new functionality:</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span>tests/unit/coal/mongodb
touch<span class="w"> </span>tests/unit/coal/mongodb/__init__.py
touch<span class="w"> </span>tests/unit/coal/mongodb/test_store.py
</code></pre></div>
<h3 id="implementing-unit-tests">Implementing Unit Tests<a class="headerlink" href="#implementing-unit-tests" title="Permanent link">&para;</a></h3>
<p>Now, let's implement the unit tests for the MongoDB store functionality:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Copyright (C) - 2023 - 2025 - Cosmo Tech</span>
<span class="c1"># This document and all information contained herein is the exclusive property -</span>
<span class="c1"># including all intellectual property rights pertaining thereto - of Cosmo Tech.</span>
<span class="c1"># Any use, reproduction, translation, broadcasting, transmission, distribution,</span>
<span class="c1"># etc., to any person is prohibited unless it has been previously and</span>
<span class="c1"># specifically authorized by written means by Cosmo Tech.</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">unittest.mock</span><span class="w"> </span><span class="kn">import</span> <span class="n">patch</span><span class="p">,</span> <span class="n">MagicMock</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pyarrow</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">cosmotech.coal.mongodb.store</span><span class="w"> </span><span class="kn">import</span> <span class="n">send_pyarrow_table_to_mongodb</span><span class="p">,</span> <span class="n">dump_store_to_mongodb</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cosmotech.coal.store.store</span><span class="w"> </span><span class="kn">import</span> <span class="n">Store</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">sample_table</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a sample PyArrow table for testing.&quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;Charlie&quot;</span><span class="p">],</span>
        <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">35</span><span class="p">],</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">pyarrow</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">temp_store</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a temporary store for testing.&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">temp_dir</span><span class="p">:</span>
        <span class="n">store</span> <span class="o">=</span> <span class="n">Store</span><span class="p">(</span><span class="n">store_location</span><span class="o">=</span><span class="n">temp_dir</span><span class="p">)</span>
        <span class="k">yield</span> <span class="n">store</span><span class="p">,</span> <span class="n">temp_dir</span>


<span class="k">class</span><span class="w"> </span><span class="nc">TestSendPyarrowTableToMongoDB</span><span class="p">:</span>
    <span class="nd">@patch</span><span class="p">(</span><span class="s2">&quot;pymongo.MongoClient&quot;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_send_pyarrow_table_to_mongodb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mock_client</span><span class="p">,</span> <span class="n">sample_table</span><span class="p">):</span>
        <span class="c1"># Set up mocks</span>
        <span class="n">mock_db</span> <span class="o">=</span> <span class="n">MagicMock</span><span class="p">()</span>
        <span class="n">mock_collection</span> <span class="o">=</span> <span class="n">MagicMock</span><span class="p">()</span>
        <span class="n">mock_client</span><span class="o">.</span><span class="n">return_value</span><span class="o">.</span><span class="fm">__getitem__</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="n">mock_db</span>
        <span class="n">mock_db</span><span class="o">.</span><span class="fm">__getitem__</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="n">mock_collection</span>
        <span class="n">mock_db</span><span class="o">.</span><span class="n">list_collection_names</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">mock_collection</span><span class="o">.</span><span class="n">insert_many</span><span class="o">.</span><span class="n">return_value</span><span class="o">.</span><span class="n">inserted_ids</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id1&quot;</span><span class="p">,</span> <span class="s2">&quot;id2&quot;</span><span class="p">,</span> <span class="s2">&quot;id3&quot;</span><span class="p">]</span>

        <span class="c1"># Call the function</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">send_pyarrow_table_to_mongodb</span><span class="p">(</span>
            <span class="n">sample_table</span><span class="p">,</span>
            <span class="s2">&quot;test_collection&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mongodb://localhost:27017&quot;</span><span class="p">,</span>
            <span class="s2">&quot;test_db&quot;</span><span class="p">,</span>
            <span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Verify the result</span>
        <span class="k">assert</span> <span class="n">result</span> <span class="o">==</span> <span class="mi">3</span>
        <span class="n">mock_client</span><span class="o">.</span><span class="n">assert_called_once_with</span><span class="p">(</span><span class="s2">&quot;mongodb://localhost:27017&quot;</span><span class="p">)</span>
        <span class="n">mock_client</span><span class="o">.</span><span class="n">return_value</span><span class="o">.</span><span class="fm">__getitem__</span><span class="o">.</span><span class="n">assert_called_once_with</span><span class="p">(</span><span class="s2">&quot;test_db&quot;</span><span class="p">)</span>
        <span class="n">mock_db</span><span class="o">.</span><span class="n">list_collection_names</span><span class="o">.</span><span class="n">assert_called_once</span><span class="p">()</span>
        <span class="n">mock_collection</span><span class="o">.</span><span class="n">insert_many</span><span class="o">.</span><span class="n">assert_called_once</span><span class="p">()</span>

    <span class="nd">@patch</span><span class="p">(</span><span class="s2">&quot;pymongo.MongoClient&quot;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_send_pyarrow_table_to_mongodb_replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mock_client</span><span class="p">,</span> <span class="n">sample_table</span><span class="p">):</span>
        <span class="c1"># Set up mocks</span>
        <span class="n">mock_db</span> <span class="o">=</span> <span class="n">MagicMock</span><span class="p">()</span>
        <span class="n">mock_collection</span> <span class="o">=</span> <span class="n">MagicMock</span><span class="p">()</span>
        <span class="n">mock_client</span><span class="o">.</span><span class="n">return_value</span><span class="o">.</span><span class="fm">__getitem__</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="n">mock_db</span>
        <span class="n">mock_db</span><span class="o">.</span><span class="fm">__getitem__</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="n">mock_collection</span>
        <span class="n">mock_db</span><span class="o">.</span><span class="n">list_collection_names</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;test_collection&quot;</span><span class="p">]</span>
        <span class="n">mock_collection</span><span class="o">.</span><span class="n">insert_many</span><span class="o">.</span><span class="n">return_value</span><span class="o">.</span><span class="n">inserted_ids</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id1&quot;</span><span class="p">,</span> <span class="s2">&quot;id2&quot;</span><span class="p">,</span> <span class="s2">&quot;id3&quot;</span><span class="p">]</span>

        <span class="c1"># Call the function</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">send_pyarrow_table_to_mongodb</span><span class="p">(</span>
            <span class="n">sample_table</span><span class="p">,</span>
            <span class="s2">&quot;test_collection&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mongodb://localhost:27017&quot;</span><span class="p">,</span>
            <span class="s2">&quot;test_db&quot;</span><span class="p">,</span>
            <span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Verify the result</span>
        <span class="k">assert</span> <span class="n">result</span> <span class="o">==</span> <span class="mi">3</span>
        <span class="n">mock_client</span><span class="o">.</span><span class="n">assert_called_once_with</span><span class="p">(</span><span class="s2">&quot;mongodb://localhost:27017&quot;</span><span class="p">)</span>
        <span class="n">mock_client</span><span class="o">.</span><span class="n">return_value</span><span class="o">.</span><span class="fm">__getitem__</span><span class="o">.</span><span class="n">assert_called_once_with</span><span class="p">(</span><span class="s2">&quot;test_db&quot;</span><span class="p">)</span>
        <span class="n">mock_db</span><span class="o">.</span><span class="n">list_collection_names</span><span class="o">.</span><span class="n">assert_called_once</span><span class="p">()</span>
        <span class="n">mock_collection</span><span class="o">.</span><span class="n">drop</span><span class="o">.</span><span class="n">assert_called_once</span><span class="p">()</span>
        <span class="n">mock_collection</span><span class="o">.</span><span class="n">insert_many</span><span class="o">.</span><span class="n">assert_called_once</span><span class="p">()</span>

    <span class="nd">@patch</span><span class="p">(</span><span class="s2">&quot;pymongo.MongoClient&quot;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_send_pyarrow_table_to_mongodb_append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mock_client</span><span class="p">,</span> <span class="n">sample_table</span><span class="p">):</span>
        <span class="c1"># Set up mocks</span>
        <span class="n">mock_db</span> <span class="o">=</span> <span class="n">MagicMock</span><span class="p">()</span>
        <span class="n">mock_collection</span> <span class="o">=</span> <span class="n">MagicMock</span><span class="p">()</span>
        <span class="n">mock_client</span><span class="o">.</span><span class="n">return_value</span><span class="o">.</span><span class="fm">__getitem__</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="n">mock_db</span>
        <span class="n">mock_db</span><span class="o">.</span><span class="fm">__getitem__</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="n">mock_collection</span>
        <span class="n">mock_db</span><span class="o">.</span><span class="n">list_collection_names</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;test_collection&quot;</span><span class="p">]</span>
        <span class="n">mock_collection</span><span class="o">.</span><span class="n">insert_many</span><span class="o">.</span><span class="n">return_value</span><span class="o">.</span><span class="n">inserted_ids</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id1&quot;</span><span class="p">,</span> <span class="s2">&quot;id2&quot;</span><span class="p">,</span> <span class="s2">&quot;id3&quot;</span><span class="p">]</span>

        <span class="c1"># Call the function</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">send_pyarrow_table_to_mongodb</span><span class="p">(</span>
            <span class="n">sample_table</span><span class="p">,</span>
            <span class="s2">&quot;test_collection&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mongodb://localhost:27017&quot;</span><span class="p">,</span>
            <span class="s2">&quot;test_db&quot;</span><span class="p">,</span>
            <span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Verify the result</span>
        <span class="k">assert</span> <span class="n">result</span> <span class="o">==</span> <span class="mi">3</span>
        <span class="n">mock_client</span><span class="o">.</span><span class="n">assert_called_once_with</span><span class="p">(</span><span class="s2">&quot;mongodb://localhost:27017&quot;</span><span class="p">)</span>
        <span class="n">mock_client</span><span class="o">.</span><span class="n">return_value</span><span class="o">.</span><span class="fm">__getitem__</span><span class="o">.</span><span class="n">assert_called_once_with</span><span class="p">(</span><span class="s2">&quot;test_db&quot;</span><span class="p">)</span>
        <span class="n">mock_db</span><span class="o">.</span><span class="n">list_collection_names</span><span class="o">.</span><span class="n">assert_called_once</span><span class="p">()</span>
        <span class="n">mock_collection</span><span class="o">.</span><span class="n">drop</span><span class="o">.</span><span class="n">assert_not_called</span><span class="p">()</span>
        <span class="n">mock_collection</span><span class="o">.</span><span class="n">insert_many</span><span class="o">.</span><span class="n">assert_called_once</span><span class="p">()</span>

    <span class="nd">@patch</span><span class="p">(</span><span class="s2">&quot;pymongo.MongoClient&quot;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_send_pyarrow_table_to_mongodb_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mock_client</span><span class="p">):</span>
        <span class="c1"># Set up mocks</span>
        <span class="n">mock_db</span> <span class="o">=</span> <span class="n">MagicMock</span><span class="p">()</span>
        <span class="n">mock_collection</span> <span class="o">=</span> <span class="n">MagicMock</span><span class="p">()</span>
        <span class="n">mock_client</span><span class="o">.</span><span class="n">return_value</span><span class="o">.</span><span class="fm">__getitem__</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="n">mock_db</span>
        <span class="n">mock_db</span><span class="o">.</span><span class="fm">__getitem__</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="n">mock_collection</span>
        <span class="n">mock_db</span><span class="o">.</span><span class="n">list_collection_names</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Create an empty table</span>
        <span class="n">empty_table</span> <span class="o">=</span> <span class="n">pyarrow</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">({})</span>

        <span class="c1"># Call the function</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">send_pyarrow_table_to_mongodb</span><span class="p">(</span>
            <span class="n">empty_table</span><span class="p">,</span>
            <span class="s2">&quot;test_collection&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mongodb://localhost:27017&quot;</span><span class="p">,</span>
            <span class="s2">&quot;test_db&quot;</span><span class="p">,</span>
            <span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Verify the result</span>
        <span class="k">assert</span> <span class="n">result</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="n">mock_client</span><span class="o">.</span><span class="n">assert_called_once_with</span><span class="p">(</span><span class="s2">&quot;mongodb://localhost:27017&quot;</span><span class="p">)</span>
        <span class="n">mock_client</span><span class="o">.</span><span class="n">return_value</span><span class="o">.</span><span class="fm">__getitem__</span><span class="o">.</span><span class="n">assert_called_once_with</span><span class="p">(</span><span class="s2">&quot;test_db&quot;</span><span class="p">)</span>
        <span class="n">mock_db</span><span class="o">.</span><span class="n">list_collection_names</span><span class="o">.</span><span class="n">assert_called_once</span><span class="p">()</span>
        <span class="n">mock_collection</span><span class="o">.</span><span class="n">insert_many</span><span class="o">.</span><span class="n">assert_not_called</span><span class="p">()</span>


<span class="k">class</span><span class="w"> </span><span class="nc">TestDumpStoreToMongoDB</span><span class="p">:</span>
    <span class="nd">@patch</span><span class="p">(</span><span class="s2">&quot;cosmotech.coal.mongodb.store.send_pyarrow_table_to_mongodb&quot;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_dump_store_to_mongodb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mock_send</span><span class="p">,</span> <span class="n">temp_store</span><span class="p">):</span>
        <span class="n">store</span><span class="p">,</span> <span class="n">temp_dir</span> <span class="o">=</span> <span class="n">temp_store</span>

        <span class="c1"># Add a table to the store</span>
        <span class="n">sample_data</span> <span class="o">=</span> <span class="n">pyarrow</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;Charlie&quot;</span><span class="p">],</span>
                <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">35</span><span class="p">],</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="n">store</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s2">&quot;test_table&quot;</span><span class="p">,</span> <span class="n">sample_data</span><span class="p">)</span>

        <span class="c1"># Set up mock</span>
        <span class="n">mock_send</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="mi">3</span>

        <span class="c1"># Call the function</span>
        <span class="n">dump_store_to_mongodb</span><span class="p">(</span>
            <span class="n">temp_dir</span><span class="p">,</span>
            <span class="s2">&quot;mongodb://localhost:27017&quot;</span><span class="p">,</span>
            <span class="s2">&quot;test_db&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Cosmotech_&quot;</span><span class="p">,</span>
            <span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Verify the mock was called correctly</span>
        <span class="n">mock_send</span><span class="o">.</span><span class="n">assert_called_once</span><span class="p">()</span>
        <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">mock_send</span><span class="o">.</span><span class="n">call_args</span>
        <span class="k">assert</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;collection_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Cosmotech_test_table&quot;</span>
        <span class="k">assert</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;mongodb_uri&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;mongodb://localhost:27017&quot;</span>
        <span class="k">assert</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;mongodb_db&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;test_db&quot;</span>
        <span class="k">assert</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;replace&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span>

    <span class="nd">@patch</span><span class="p">(</span><span class="s2">&quot;cosmotech.coal.mongodb.store.send_pyarrow_table_to_mongodb&quot;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_dump_store_to_mongodb_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mock_send</span><span class="p">,</span> <span class="n">temp_store</span><span class="p">):</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">temp_dir</span> <span class="o">=</span> <span class="n">temp_store</span>

        <span class="c1"># Call the function with an empty store</span>
        <span class="n">dump_store_to_mongodb</span><span class="p">(</span>
            <span class="n">temp_dir</span><span class="p">,</span>
            <span class="s2">&quot;mongodb://localhost:27017&quot;</span><span class="p">,</span>
            <span class="s2">&quot;test_db&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Cosmotech_&quot;</span><span class="p">,</span>
            <span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Verify the mock was not called</span>
        <span class="n">mock_send</span><span class="o">.</span><span class="n">assert_not_called</span><span class="p">()</span>

    <span class="nd">@patch</span><span class="p">(</span><span class="s2">&quot;cosmotech.coal.mongodb.store.send_pyarrow_table_to_mongodb&quot;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_dump_store_to_mongodb_multiple_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mock_send</span><span class="p">,</span> <span class="n">temp_store</span><span class="p">):</span>
        <span class="n">store</span><span class="p">,</span> <span class="n">temp_dir</span> <span class="o">=</span> <span class="n">temp_store</span>

        <span class="c1"># Add multiple tables to the store</span>
        <span class="n">table1</span> <span class="o">=</span> <span class="n">pyarrow</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;Charlie&quot;</span><span class="p">],</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="n">table2</span> <span class="o">=</span> <span class="n">pyarrow</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Dave&quot;</span><span class="p">,</span> <span class="s2">&quot;Eve&quot;</span><span class="p">],</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="n">store</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s2">&quot;table1&quot;</span><span class="p">,</span> <span class="n">table1</span><span class="p">)</span>
        <span class="n">store</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s2">&quot;table2&quot;</span><span class="p">,</span> <span class="n">table2</span><span class="p">)</span>

        <span class="c1"># Set up mock</span>
        <span class="n">mock_send</span><span class="o">.</span><span class="n">side_effect</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>

        <span class="c1"># Call the function</span>
        <span class="n">dump_store_to_mongodb</span><span class="p">(</span>
            <span class="n">temp_dir</span><span class="p">,</span>
            <span class="s2">&quot;mongodb://localhost:27017&quot;</span><span class="p">,</span>
            <span class="s2">&quot;test_db&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Cosmotech_&quot;</span><span class="p">,</span>
            <span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Verify the mock was called correctly for each table</span>
        <span class="k">assert</span> <span class="n">mock_send</span><span class="o">.</span><span class="n">call_count</span> <span class="o">==</span> <span class="mi">2</span>
        <span class="n">call_args_list</span> <span class="o">=</span> <span class="n">mock_send</span><span class="o">.</span><span class="n">call_args_list</span>

        <span class="c1"># Check first call</span>
        <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">call_args_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">assert</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;collection_name&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Cosmotech_table1&quot;</span><span class="p">,</span> <span class="s2">&quot;Cosmotech_table2&quot;</span><span class="p">]</span>

        <span class="c1"># Check second call</span>
        <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">call_args_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">assert</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;collection_name&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Cosmotech_table1&quot;</span><span class="p">,</span> <span class="s2">&quot;Cosmotech_table2&quot;</span><span class="p">]</span>

        <span class="c1"># Ensure both tables were processed</span>
        <span class="n">collection_names</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">call_args_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;collection_name&quot;</span><span class="p">],</span>
            <span class="n">call_args_list</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;collection_name&quot;</span><span class="p">],</span>
        <span class="p">]</span>
        <span class="k">assert</span> <span class="s2">&quot;Cosmotech_table1&quot;</span> <span class="ow">in</span> <span class="n">collection_names</span>
        <span class="k">assert</span> <span class="s2">&quot;Cosmotech_table2&quot;</span> <span class="ow">in</span> <span class="n">collection_names</span>
</code></pre></div>
<h3 id="running-the-tests">Running the Tests<a class="headerlink" href="#running-the-tests" title="Permanent link">&para;</a></h3>
<p>To run the tests, use pytest:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Run all tests</span>
pytest<span class="w"> </span>tests/unit/coal/mongodb/

<span class="c1"># Run with coverage</span>
pytest<span class="w"> </span>tests/unit/coal/mongodb/<span class="w"> </span>--cov<span class="o">=</span>cosmotech.coal.mongodb<span class="w"> </span>--cov-report<span class="o">=</span>term-missing
</code></pre></div>
<p>Make sure all tests pass and that you have adequate code coverage (at least 80%).</p>
<h2 id="documentation">Documentation<a class="headerlink" href="#documentation" title="Permanent link">&para;</a></h2>
<p>Documentation is a critical part of the contribution process. All new features must be documented to ensure users can understand and use them effectively.</p>
<h3 id="updating-cli-documentation">Updating CLI Documentation<a class="headerlink" href="#updating-cli-documentation" title="Permanent link">&para;</a></h3>
<p>Let's add csm-data documentation for our new functionality. Create a new file:</p>
<div class="highlight"><pre><span></span><code>touch<span class="w"> </span>docs/csm-data/store/dump-to-mongodb.md
</code></pre></div>
<p>Add the following content:</p>
<div class="highlight"><pre><span></span><code>---
hide:
<span class="w">  </span><span class="k">-</span><span class="w"> </span>toc
<span class="gu">description: &quot;Command help: `csm-data store dump-to-mongodb`&quot;</span>
<span class="gu">---</span>
<span class="gh"># dump-to-mongodb</span>

!!! info &quot;Help command&quot;
<span class="sb">    ```text</span>
<span class="sb">    ```</span>
</code></pre></div>
<p>The documentation build system will generate the content that will be inserted in the file to add a minimal documentation. You can then add more elements as necessary.</p>
<h2 id="pull-request-checklist">Pull Request Checklist<a class="headerlink" href="#pull-request-checklist" title="Permanent link">&para;</a></h2>
<p>Before submitting your pull request, make sure you've completed all the necessary steps:</p>
<ol>
<li>Code Quality<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Code follows the project's style guidelines (Black formatting)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> All linting checks pass</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Code is well-documented with docstrings</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Code is efficient and follows best practices</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> No unnecessary dependencies are added</li>
</ul>
</li>
<li>Testing<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> All unit tests pass</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Test coverage meets or exceeds 80%</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> All functions have at least one test</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Edge cases and error conditions are tested</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Mocks are used for external services</li>
</ul>
</li>
<li>Documentation<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> API documentation is updated</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Command help text is clear and comprehensive</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Translation strings are added for all user-facing text</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Usage examples are provided</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Any necessary tutorials are created or updated</li>
</ul>
</li>
<li>Integration<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> New functionality integrates well with existing code</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> No breaking changes to existing APIs</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Dependencies are properly specified in pyproject.toml</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Command is registered in the appropriate <strong>init</strong>.py file</li>
</ul>
</li>
<li>Pull Request Description<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Clear description of the changes</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Explanation of why the changes are needed</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Any potential issues or limitations</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> References to related issues or discussions</li>
</ul>
</li>
</ol>
<h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h2>
<p>Congratulations! You've now learned how to contribute to CoAL by implementing a new feature, creating a new csm-data command, writing unit tests, and documenting your work.</p>
<p>By following this tutorial, you've gained practical experience with:</p>
<ul>
<li>Setting up your development environment with Black and pre-commit hooks</li>
<li>Understanding the CoAL architecture</li>
<li>Implementing new functionality</li>
<li>Creating CLI commands</li>
<li>Writing unit tests</li>
<li>Documenting your work</li>
<li>Preparing for a pull request</li>
</ul>
<p>You're now ready to contribute your own features to CoAL and help improve the platform for everyone.</p>
<p>Remember that the CoAL community is here to help. If you have any questions or need assistance, don't hesitate to reach out through GitHub issues or discussions.</p>
<p>Happy contributing!</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../" class="md-footer__link md-footer__link--prev" aria-label="Previous: Tutorials">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Tutorials
              </div>
            </div>
          </a>
        
        
          
          <a href="../cosmotech-api/" class="md-footer__link md-footer__link--next" aria-label="Next: Working with the CosmoTech API">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Working with the CosmoTech API
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
    
    Made by
    <a href="https://cosmotech.com/" target="_blank" rel="noopener">
        Cosmotech
    </a>
    <br/>
    <br/>
    <a href="#__consent">Change cookie settings</a>
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  
    
  



  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.code.annotate", "content.tooltips", "navigation.tabs", "navigation.tabs.sticky", "navigation.expand", "navigation.top", "navigation.indexes", "navigation.instant", "navigation.footer", "navigation.sections"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.3220b9d7.min.js"></script>
      
        <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
      
        <script src="../../javascript/tablesort.js"></script>
      
    
  </body>
</html>